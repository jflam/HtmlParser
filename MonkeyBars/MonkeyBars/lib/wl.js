(function(){if(!window.WL){var Te="WL.Internal.jsonp.",nf=2000,Lc="body",D="callback",Mc="code",Mb="error",jf="error_description",tc="logging",ce="tracing",uc="message",E="method",lb="file_input",qc="file_name",Cb="file_output",Eb="overwrite",w="path",ne="pretty",vf="result",wf="status",Id="return_ssl_resources",pf="success",xf="error",Cd="suppress_redirects",Zb="suppress_response_codes",C="x_http_live_library",Ec=0,hc=1,f="access_token",x="authentication_token",m="client_id",Ge="display",cd="code",z="error",bb="error_description",U="expires",R="expires_in",Ke="locale",ab="redirect_uri",mb="response_type",Bf="request_ts",e="scope",Wc="session",me="secure_cookie",Me="state",d="status",Kc=[f,x,e,R,U],n="connected",Fc="notConnected",G="unchecked",y="unknown",qb="expiring",rb="expired",Gc="live-sdk-upload",vc="live-sdk-download",Oe="appId",xe="channelUrl",Ee="wl_auth",Ff="app",Cf="popup",Qc="page",Df="touch",S="none",nb="auth.login",Jb="auth.logout",gb="auth.sessionChange",yb="auth.statusChange",Zc="wl.log",oc="access_denied",cf="connection_failed",rf="invalid_cookie",Kb="request_canceled",k="request_failed",ue="timed_out",yc="unknown_user",Sd="user_rejected",Ye="The request could not be completed due to browser issues.",Ze="The request could not be completed due to browser limitations.",Ib="METHOD: The operation has been canceled.",We="The 'wl_auth' cookie is not valid.",Ve="The 'wl_auth' cookie has been modified incorrectly. Ensure that the redirect URI only modifies sub-keys for values received from the OAuth endpoint.",jd="The 'wl_auth' cookie has multiple values. Ensure that the redirect URI specifies a cookie domain and path when setting cookies.",Ed="METHOD: The input parameter 'PARAM' does not reference a valid DOM element.",Md="METHOD: An exception was received for EVENT. Detail: MESSAGE",Fd="METHOD: The WL object must be initialized with WL.init() prior to invoking this method.",Bd="A connection to the server could not be established.",Ue="The user could not be identified.",df="The pending login request has been canceled.",wd="METHOD: The input parameter 'PARAM' is not valid.",xd="METHOD: The input parameter 'PARAM' must be included.",nd="METHOD: The type of the provided value for the input parameter 'PARAM' is not valid.",Wb="WL.login: There is a pending WL.login request, the current call will be ignored.",md="METHOD: The input parameter 'redirect_uri' is required if the value of the 'response_type' parameter is 'code'.",Yb="METHOD: The api call is not supported on this platform.",ed="WL.init: The response_type value 'code' is not supported on this platform.",sf="METHOD: The input parameter 'redirect_uri' must use https: to match the scheme of the current page.",af="The auth request is timed out.",ff="The popup is closed without receiving consent.",uf=0,Xe=1,bf=2,tf=3,ob="get",pe="post",Af="put",Yd="delete",yf="copy",zf="move",ef=30000,j="onSuccess",o="onError",t="onProgress",ae="code",Gb="token",Sc="https:",Vc="http:",Ce="wl.signin",je=/\s|,/,db="boolean",l="function",Fe="number",b="string",I="object",Hb="string_or_array",Ae="name",Lb="element",Q="brand",Sb="type",kb="sign_in_text",ib="sign_out_text",r="theme",be="messenger",re="hotmail",le="skydrive",Dc="windows",lf="windowslive",cb="none",Vb="signin",Bb=Vb,nc="login",kc="connect",lc="custom",mf="blue",hf="white",X="dark",Ld="light",eb="sdk_root",Gf="wl_trace",B={name:D,type:l,optional:true},td={name:D,type:l,optional:false};window.WL={init:function(f){try{var c=H(f);pb(c,{name:"properties",type:"properties",optional:false,properties:[{name:m,altName:Oe,type:b,optional:!se()},{name:e,type:Hb,optional:true},{name:ab,altName:xe,type:"url",optional:true},{name:mb,type:b,allowedValues:[ae,Gb],optional:true},{name:tc,type:db,optional:true},{name:d,type:db,optional:true}]},"WL.init");if(!c[ab]&&c[mb]===cd)throw new Error(md.replace("METHOD","WL.init"));if(c[d]==null)c[d]=true;a.appInit(c)}catch(g){A(g.message)}},login:function(){try{var b=Y(arguments);p(b,[{name:e,type:Hb,optional:true},{name:ab,type:"url",optional:true},B],"WL.login");return a.login(b)}catch(f){return M("WL.login",f)}},getSession:function(){try{return a.getSession()}catch(b){A(b.message)}},getLoginStatus:function(){try{return a.getLoginStatus({callback:sc(arguments,l,2),internal:false},sc(arguments,db,2))}catch(d){return M("WL.getLoginStatus",d)}},logout:function(b){try{pb(b,B,"WL.logout");return a.logout({callback:b})}catch(c){return M("WL.logout",c)}},ui:function(){try{var c=Y(arguments);p(c,[{name:Ae,type:b,allowedValues:[Vb],optional:false},B],"WL.ui");a.ui(c)}catch(f){A(f.message)}},api:function(){try{var c=Jd(arguments);p(c,[{name:w,type:b,optional:false},{name:E,type:b,optional:true},B],"WL.api");return a.api(c)}catch(f){return M("WL.api",f)}},download:function(){try{if(!a.download)throw new Error(Yb.replace("METHOD","WL.download"));var c=Y(arguments);p(c,[{name:w,type:b,optional:false},{name:Cb,type:I,optional:false},B],"WL.download");return a.download(c)}catch(f){return M("WL.download",f)}},upload:function(){try{if(!a.upload)throw new Error(Yb.replace("METHOD","WL.upload"));var c=Y(arguments);p(c,[{name:w,type:b,optional:false},{name:qc,type:b,optional:true},{name:lb,type:I,optional:false},{name:Eb,type:db,optional:true},B],"WL.upload");return a.upload(c)}catch(f){return M("WL.upload",f)}}};var Oc=[nb,Jb,gb,yb,Zc];WL.Event={subscribe:function(d,a){try{pb([d,a],[{name:"event",type:b,allowedValues:Oc,caseSensitive:true,optional:false},td],"WL.Event.subscribe");c.subscribe(d,a)}catch(e){A(e.message)}},unsubscribe:function(d,a){try{pb([d,a],[{name:"event",type:b,allowedValues:Oc,caseSensitive:true,optional:false},B],"WL.Event.unsubscribe");c.unsubscribe(d,a)}catch(e){A(e.message)}}};WL.Internal={};function Y(g){var e=Yc(g),a=null,b=null;for(var d=0;d<e.length;d++){var c=e[d],f=typeof c;if(f===I&&a===null)a=H(c);else if(f===l&&b===null)b=c}a=a||{};if(b)a.callback=b;return a}function Jd(e){var a=Yc(e),d=null,c=null;if(typeof a[0]===b){d=a.shift();if(typeof a[0]===b)c=a.shift()}normalizedArgs=Y(a);if(d!==null){normalizedArgs[w]=d;if(c!=null)normalizedArgs[E]=c}return normalizedArgs}function M(a,c){var b=fc(a,a,c);A(b.message);return jb(a,false,null,b)}var c={subscribe:function(a,b){g("Subscribe "+a);var d=c.getHandlers(a);d.push(b)},unsubscribe:function(d,f){g("Unsubscribe "+d);var b=c.getHandlers(d),e=[];if(f!=null){var h=false;for(var a=0;a<b.length;a++)if(h||b[a]!=f)e.push(b[a]);else h=true}c._eHandlers[d]=e},getHandlers:function(b){if(!c._eHandlers)c._eHandlers={};var a=c._eHandlers[b];if(a==null)c._eHandlers[b]=a=[];return a},notify:function(d,e){g("Notify "+d);var b=c.getHandlers(d);for(var a=0;a<b.length;a++)b[a](e)}},a={_status:Ec,_statusRequests:[]};a.appInit=function(b){if(a._status==hc)return;var f=WL[eb];if(f){if(f.charAt(f.length-1)!=="/")f+="/";a[eb]=f}var i=b[tc];if(i===false)a._logEnabled=i;a._authScope=pc(b[e]);a._secureCookie=Kd(b[me]);zd(b);var h=new T(b[m],Ee);a._session=h;a._status=hc;var g=h.getNormalStatus(),j=g[d];if(j==n){c.notify(gb,g);c.notify(yb,g);c.notify(nb,g)}else if(b[d])a.getLoginStatus({internal:true},kd())};a.onloadInit=function(){te();ve()};function v(b){if(a._status===Ec)throw new Error(Fd.replace("METHOD",b))}a.api=function(a){v("WL.api");var c=a[Lc];if(c){a=H(Ob(c),a);delete a[Lc]}var b=a[E];a[E]=(b!=null?J(b):ob).toLowerCase();return (new Xc(a)).execute()};var Nd=function(){var b=a.api.lastId,c;b=b===undefined?1:b+1;c="WLAPI_REQ_"+b+"_"+(new Date).getTime();a.api.lastId=b;return c},Xc=function(b){var c=this;c._properties=b;c._completed=false;c._id=Nd();b[ne]=false;b[Id]=a._isHttps;b[C]=a[C];var d=b[w];c._url=Cc()+(d.charAt(0)==="/"?d.substring(1):d);c._promise=new h("WL.api",null,null)};Xc.prototype={execute:function(){ee(this);return this._promise},onCompleted:function(a){if(this._completed)return;this._completed=true;P(this._properties.callback,a,true);if(a[z])this._promise[o](a);else this._promise[j](a)}};function Zd(e,c,a,d){a=a?J(a):"";var b=a!==""?Hc(a):null;if(b===null){b={};if(c/100!==2)b[Mb]=wc(c,d)}e.onCompleted(b)}function wc(c,b){var a={};a[Mc]=k;a[uc]=b||Bd;return a}function mc(){var c=null,b=a._session.getStatus();if(b.status===qb||b.status===n)c=b.session[f];return c}function Ob(i){var c={};for(var b in i){var a=i[b],j=typeof a;if(a instanceof Array)for(var d=0;d<a.length;d++){var f=a[d],l=typeof f;if(j==I&&!(a instanceof Date)){var h=Ob(f);for(var e in h)c[b+"."+d+"."+e]=h[e]}else c[b+"."+d]=f}else if(j==I&&!(a instanceof Date)){var k=Ob(a);for(var g in k)c[b+"."+g]=k[g]}else c[b]=a}return c}function Pd(c){if(!Ne())return false;var b=he(c),a=new XMLHttpRequest;a.open(b.method,b.url,true);var d=c._properties[E];if(b.method!=ob)a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.onreadystatechange=function(){if(a.readyState==4)Zd(c,a.status,a.responseText)};a.send(b.body);return true}function he(d){var a=de(d._properties,null,[D,w,E]),e=d._properties[E],g=Fb(d._url,{"ts":(new Date).getTime()}),h=mc(),c,b;a[Cd]="true";a[Zb]="true";if(h!=null)a[f]=h;if(e===ob||e===Yd){c=null;b=ob;g+="&"+O(a)}else{c=O(a);b=pe}g+="&method="+e;return {url:g,method:b,body:c}}a.login=function(b,d){v("WL.login");Td(b);if(!Xd(d))return jb("WL.login",false,null,u(k,Wb));var c=a._session.tryGetResponse(b.normalizedScope);if(c!=null)return jb("WL.login",true,b.callback,c);a._pendingLogin=Wd(b,Gd);return a._pendingLogin.execute()};function Gd(d,b){a._pendingLogin=null;var c=b[z];if(c){if(c==Sd)g("wl_app-onAuthRequestCompleted: "+b[bb]);else L("WL.login: "+b[bb]);return}else P(d.callback,b,true)}function Td(c){var b=pc(c[e]);if(b==="")b=a._authScope;if(!b||b==="")throw xb(e,"WL.login");c.normalizedScope=b}function pc(b){var a=b||"";if(a instanceof Array)a=a.join(" ");return J(a)}a.getSession=function(){v("WL.getSession");return a._session.getStatus()[Wc]};a.getLoginStatus=function(b,f){v("WL.getLoginStatus");b=b||{};if(!f){var d=a._session.tryGetResponse();if(d)return jb("WL.getLoginStatus",true,b.callback,d)}g("wl_app:getLoginStatus");var e=a._statusRequests,c=null;if(!a._pendingStatusRequest){c=vd(b,ud);a._pendingStatusRequest=c}e.push(b);if(c!=null)c.execute();return a._pendingStatusRequest._promise};function ud(i,b){var f=a._statusRequests;a._pendingStatusRequest=null;g("wl_app:onGetLoginStatusCompleted");var d=b[z],e=false;while(f.length>0){var c=f.shift(),h=H(b);if(!d||c.internal)P(c.callback,h,true);if(!c.internal)e=true}if(d)if(e&&d!==ue)L("WL.getLoginStatus: "+b[bb]);else g("wl_app-onGetLoginStatusCompleted: "+b[bb])}a.logout=function(e){v("WL.logout");var c=new h("WL.logout",null,null),d=function(){var a=b.getNormalStatus();P(e.callback,a,false);c[j](a)},b=a._session;if(b.isSignedIn()){b.updateStatus(y);ge(d)}else d();return c};a.ui=function(a){v("WL.ui");if(a.name===Vb)new F(a)};a.ui.styles={};var F=function(c){var a=this;a._properties=c;var b=q(a,a.init);rc(b)};F.prototype={init:function(){if(this._inited===true)return;this._inited=true;try{this.validate();var e=this,d=e._properties,f=d[Lb],g=d[Sb],j=d[D],i=d[kb],h=d[ib];pd(d);f=typeof f===b?Pb(d[Lb]):f;e._element=f;g=g!=null?g:Bb;if(g==Bb){i=K.signIn;h=K.signOut}else if(g==nc){i=K.login;h=K.logout}else if(g==kc){i=K.connect;h=K.signOut}e[kb]=i;e[ib]=h;De(f,Dd(d));e.setText(a._session.isSignedIn()?h:i);ld(e,f.childNodes[0]);c.subscribe(nb,q(e,e.onLoggedIn));c.subscribe(Jb,q(e,e.onLoggedOut));a.getLoginStatus({internal:true});delete d[D];P(j,d,false)}catch(k){A(k.message)}},validate:function(){var a=this._properties;p(a,[{name:Lb,type:"dom",optional:false},{name:Sb,allowedValues:[Bb,nc,kc,lc],type:b,optional:true},{name:e,type:Hb,optional:true}],"WL.ui(name:'signin')");dd(a);var c=a[Sb];if(c==lc)p(a,[{name:kb,type:b,optional:false},{name:ib,type:b,optional:false}],"WL.ui(name:'signin')")},onClick:function(){if(this._element.childNodes.length==0){tb(this);return}if(a._session.isSignedIn())a.logout({});else a.login(this._properties,true);return false},onLoggedIn:function(){this.setText(this[ib])},onLoggedOut:function(){this.setText(this[kb])}};function pd(b){if(a._authScope&&a._authScope!=="")b[e]=a._authScope;if(!b[e])b[e]=Ce}function Rc(){return a[eb]+"images"}function V(d,a,c){a._handlers=a._handlers||{};var b=q(a,c);a._handlers[d]=b;return b}function W(b,a){return a._handlers[b]}function Le(c){var a=document.cookie;c+="=";var b=a.indexOf(c);if(b>=0){b+=c.length;var d=a.indexOf(";",b);if(d<0)d=a.length;else{postCookie=a.substring(d);if(postCookie.indexOf(c)>=0)throw new Error(jd)}var e=a.substring(b,d);return e}return ""}function ad(g,d,f,e){d=d?d:"";var c=g+"="+d+"; path=/";if(f&&f!="localhost")c+="; domain="+encodeURIComponent(f);if(e!=null){var b=new Date(0);if(e>0){b=new Date;b.setTime(b.getTime()+e*1000)}c+=";expires="+b.toUTCString()}if(a._isHttps&&a._secureCookie)c+=";secure";document.cookie=c}var Uc=function(a,b){this._cookieName=a;this._states=b||{};this._listeners=[]};Uc.prototype={getStates:function(){return this._states},get:function(a){return this._states[a]},set:function(b,a){this._states[b]=a},remove:function(a){if(this._states[a])delete this._states[a]},load:function(){try{var a=Le(this._cookieName);if(this._rawValue!=a){g("Cookie changed: "+this._cookieName+"="+a);this._rawValue=a;this._states=Ab(a);for(var b=0;b<this._listeners.length;b++)this._listeners[b]()}}catch(c){A(c.message);this.stopMonitor()}},flush:function(a){this._states=a;this.save()},populate:function(a){H(a,this._states);this.save()},save:function(){ad(this._cookieName,O(this._states),Ic(),null)},clear:function(){this._states={};ad(this._cookieName,"",Ic(),0)}};var T=function(b,a){this._state={};this._state[m]=b;this._state[d]=G;this._cookieName=a;this.init()};T.prototype={get:function(a){return this._state[a]},save:function(){if(this._stateDirty){this._cookie.flush(this._state);this._stateDirty=false}},init:function(){var a=new Uc(this._cookieName);a.load();this._cookie=a;if(a.get(m)!=this._state[m]){a.clear();a.flush(this._state)}else this._state=a.getStates();this.initPlatformSpecific()},refresh:function(){a.getLoginStatus({internal:true},true);this._refresh=undefined},scheduleRefresh:function(){this.cancelRefresh();var a=(this.tokenExpiresIn()-600)*1000;if(a>0)this._refresh=window.setTimeout(q(this,this.refresh),a)},cancelRefresh:function(){if(this._refresh){window.clearTimeout(this._refresh);this._refresh=undefined}},updateStatus:function(a){var b=this._state[d],e=this._state[f];if(b!=a){this._state[d]=a;this._stateDirty=true;this.onStatusChanged(b,a);this.save();if(e!=this._state[f])c.notify(gb,this.getNormalStatus())}},onStatusChanged:function(b,a){g("AuthSession: Auth status changed: "+b+"=>"+a);if(b!=a){var h=b==n,d=a==n;if(!d){for(var e=0;e<Kc.length;e++){var f=Kc[e];if(this._state[f])delete this._state[f]}this._stateDirty=true;this.save()}if(zb(b)!=zb(a))c.notify(yb,this.getNormalStatus());if(d!=h)if(d)c.notify(nb,this.getNormalStatus());else c.notify(Jb,this.getNormalStatus())}},isSignedIn:function(){return this._state[d]===n},getNormalStatus:function(){var a=this.getStatus();a[d]=zb(a[d]);return a},tokenExpiresIn:function(){var a=this._state,c=a[d],b=parseInt(a[U]);if(c===n)return b-Ac();return -1}};function qe(f,a){if(a==null||J(a)=="")return true;var c=a.split(je),e=f.join(" ");for(var b=0;b<c.length;b++){var d=J(c[b]);if(d!=""&&e.indexOf(d)<0)return false}return true}function J(a){return a.replace(/^\s+|\s+$/g,"")}function H(b,d){var c=d||{};if(b!=null)for(var a in b)c[a]=b[a];return c}function de(e,d,b){var c=H(e,d);for(var a=0;a<b.length;a++)delete c[b[a]];return c}function Yc(a){return Array.prototype.slice.call(a)}function q(b,a){return function(){if(typeof a===l)return a.apply(b,arguments)}}function bd(a,e){a="[WL]"+a;var b=window.console;if(b&&b.log)switch(e){case "warning":b.warn(a);break;case "error":b.error(a);break;default:b.log(a)}var d=window.opera;if(d)d.postError(a);var c=window.debugService;if(c)c.trace(a)}function g(b){if(a._traceEnabled)bd(b)}function L(b,d){if(a._logEnabled||a._traceEnabled)bd(b,d);c.notify(Zc,b)}WL.Internal.trace=g;WL.Internal.log=L;function A(a){L(a,"error")}function Pb(a){return document.getElementById(a)}function we(a,b){if(a)if(a.innerText)a.innerText=b;else{var c=document.createTextNode(b);a.innerHTML="";a.appendChild(c)}}function Se(a){H(Pe(a),this)}Se.prototype={toString:function(){var a=this;s=(a.scheme!=""?a.scheme+"//":"")+a.host+(a.port!=""?":"+a.port:"")+a.path;return s},resolve:function(){var a=this;if(a.scheme==""){var b=window.location.port,c=window.location.host;a.scheme=window.location.protocol;a.host=c.split(":")[0];a.port=b!=null?b:"";if(a.path.charAt(0)!="/")a.path=Ud(a.host,window.location.href,a.path)}}};function Pe(c){var e=c.indexOf(Sc)==0?Sc:c.indexOf(Vc)==0?Vc:"",h="",i="",f;if(e!="")var b=c.substring(e.length+2),a=b.indexOf("/"),g=a>0?b.substring(0,a):b,d=g.split(":"),h=d[0],i=d.length>1?d[1]:"",f=a>0?b.substring(a):"";else f=c;return {scheme:e,host:h,port:i,path:f}}function Ud(e,b,h){var d=function(a,c){charIdx=b.indexOf(c);a=charIdx>0?a.substring(0,charIdx):a;return a};b=d(d(b,"?"),"#");var f=b.indexOf(e),a=b.substring(f+e.length),g=a.indexOf("/"),c=a.lastIndexOf("/");a=c>=0?a.substring(g,c):a;return a+"/"+h}function P(a,b,d,c){if(a!=null){if(c)b[Me]=c;if(d)a(b);else window.setTimeout(function(){a(b)},1)}}function Hc(a){if(window.JSON)return JSON.parse(a);else return eval("("+a+")")}function Ac(){return Math.floor((new Date).getTime()/1000)}function Re(b,c){var d=b.length;for(var a=0;a<d;a++)c(b[a])}function Nb(c,b){var a={};a[z]=c;a[bb]=b;return a}function u(d,c){var a={},b={};a[Mc]=d,a[uc]=c;b[Mb]=a;return b}function fc(a,b,c){return u(k,Md.replace("METHOD",a).replace("EVENT",b).replace("MESSAGE",c.message))}function Hd(b){var a=b.split(".");return a[0]+"."+a[1]}function te(){var b=navigator.userAgent.toLowerCase();a._browser={"firefox":/firefox/.test(b),"firefox1.5":/firefox\/1\.5/.test(b),"firefox2":/firefox\/2/.test(b),"firefox3":/firefox\/3/.test(b),"firefox4":/firefox\/4/.test(b),"ie":/msie/.test(b)&&!/opera/.test(b),"ie6":false,"ie7":false,"ie8":false,"ie9":false,"opera":/opera/.test(b),"webkit":/webkit/.test(b),"mobile":/mobile/.test(b)||/phone/.test(b)};if(a._browser["ie"]){var c=0;if(document.documentMode)c=document.documentMode;else if(/msie 7/.test(b))c=7;c=Math.min(9,Math.max(c,6));a._browser["ie"+c]=true}}function Ab(e,c){var f=c!=null?c:{};if(e!=null){var d=e.split("&");for(var b=0;b<d.length;b++){var a=d[b].split("=");if(a.length==2)f[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}}return f}function O(b){var a="";if(b!=null)for(var c in b){var d=a.length==0?"":"&",e=b[c];a+=d+encodeURIComponent(c)+"="+encodeURIComponent(Vd(e))}return a}function Vd(a){if(a instanceof Date){var b=function(a,b){switch(b){case 2:return a<10?"0"+a:a;case 3:return (a<10?"00":a<100?"0":"")+a}};return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1,2)+"-"+b(a.getUTCDate(),2)+"T"+b(a.getUTCHours(),2)+":"+b(a.getUTCMinutes(),2)+":"+b(a.getUTCSeconds(),2)+"."+b(a.getUTCMilliseconds(),3)+"Z"}return ""+a}function ie(b){var d=b.indexOf("?")+1,c=b.indexOf("#")+1,a={};if(d>0){var e=c>d?c-1:b.length;a=Ab(b.substring(d,e),a)}if(c>0)a=Ab(b.substring(c),a);return a}function Fb(a,b){return a+(a.indexOf("?")<0?"?":"&")+O(b)}function Kd(a){switch(typeof a){case db:return a;case Fe:return !!a;case b:return a.toLowerCase()==="true";default:return false}}function pb(a,c,d){if(a instanceof Array)for(var b=0;b<a.length;b++)Pc(a[b],c[b],d);else Pc(a,c,d)}function Pc(c,a,b){Bc(c,a,b);if(a.type==="properties")p(c,a.properties,b)}function Bc(f,e,c){var d=e.name,a=typeof f,g=e.type;if(a==="undefined"||f==null)if(e.optional)return;else throw xb(d,c);switch(g){case "string":case "url":if(a!==b)throw N(d,c);if(!e.optional&&J(f)==="")throw xb(d,c);break;case "properties":if(a!=I)throw N(d,c);break;case "function":if(a!=l)throw N(a,c);break;case "dom":if(a==b){if(Pb(f)==null)throw new Error(Ed.replace("METHOD",c).replace("PARAM",d))}else if(a!=I)throw N(d,c);break;case "string_or_array":if(a!==b&&!(f instanceof Array))throw N(a,c);break;default:if(a!==g)throw N(d,c)}if(e.allowedValues!=null)Qd(f,e.allowedValues,e.caseSensitive,d,c)}function p(g,c,f){var d=g||{};for(var b=0;b<c.length;b++){var a=c[b],e=d[a.name]||d[a.altName];Bc(e,a,f)}}function Qd(d,a,e,f,h){var g=typeof a[0]===b;for(var c=0;c<a.length;c++)if(g&&!e){if(d.toLowerCase()===a[c].toLowerCase())return}else if(d===a[c])return;throw Ad(f,h)}function N(a,b){return new Error(nd.replace("METHOD",b).replace("PARAM",a))}function xb(a,b){return new Error(xd.replace("METHOD",b).replace("PARAM",a))}function Ad(a,b){return new Error(wd.replace("METHOD",b).replace("PARAM",a))}function sc(b,d,c){if(b)for(var a=0;a<c&&a<b.length;a++)if(d===typeof b[a])return b[a];return undefined}var h=function(b,c,a){this._name=b;this._op=c;this._uplinkPromise=a;this._isCompleted=false;this._listeners=[]};h.prototype={then:function(d,e,c){var b=new h(null,null,this),a={};a[j]=d;a[o]=e;a[t]=c;a.chainedPromise=b;this._listeners.push(a);return b},cancel:function(){if(this._isCompleted)return;if(this._uplinkPromise&&!this._uplinkPromise._isCompleted)this._uplinkPromise.cancel();else{var a=this._op?this._op.cancel:null;if(typeof a===l)this._op.cancel();else this.onError(u(Kb,Ib.replace("METHOD",this._getName())))}},_getName:function(){if(this._name)return this._name;if(this._op&&typeof this._op._getName===l)return this._op._getName();if(this._uplinkPromise)return this._uplinkPromise._getName();return ""},_onEvent:function(b,a){if(this._isCompleted)return;this._isCompleted=a!==t;this._notify(b,a)},_notify:function(b,a){var c=this;Re(this._listeners,function(g){var h=g[a],d=g.chainedPromise,f=a!==t;if(h)try{var e=h.apply(g,b);if(f&&e&&e.then){d._op=e;e.then(function(a){d[j](a)},function(a){d[o](a)},function(a){d[t](a)})}}catch(i){if(f)d.onError(fc(c._getName(),a,i))}else if(f)d[a].apply(d,b)})}};h.prototype[j]=function(){this._onEvent(arguments,j)};h.prototype[o]=function(){this._onEvent(arguments,o)};h.prototype[t]=function(){this._onEvent(arguments,t)};function jb(e,d,b,f){var a=new h(e,null,null),c=d?j:o;window.setTimeout(function(){a[c](f)},1);if(typeof b===l)a.then(function(a){b(a)});return a}var Kc=[f,x,e,R,U],Nc="apiservice_uri",Tc="auth_server",gd=-2147023579,ze="///LiveSDKHTML/",Z="ms-resource:///WLText/",K=null;function zd(b){if(b[mb]===cd)throw new Error(ed);a[C]="Windows/HTML8_"+Hd(a._version);a._isConnected=true;a._isHttps=true;if(b[ce])a._traceEnabled=true;a._env="PROD";if(!a[eb])a[eb]=ze;if(a.testInit)a.testInit(b);Ie();var c=Windows.Security.Authentication.Web.WebAuthenticationBroker.getCurrentApplicationCallbackUri().absoluteUri;b[m]=c;a._redirect_uri=c;a._response_type=Gb;fd()}function Ie(){try{var c=Windows.ApplicationModel.Resources.Core,e=c.ResourceManager,d=e.current.defaultContext.languages[0],b=c.ResourceManager.current.mainResourceMap;a._locale=(d||"en").toLowerCase();K={signIn:b.getValue(Z+"signIn").toString(),signOut:b.getValue(Z+"signOut").toString(),login:b.getValue(Z+"login").toString(),logout:b.getValue(Z+"logout").toString(),connect:b.getValue(Z+"connect").toString()}}catch(f){L(f.message)}}function ve(){a._logEnabled=true;a._traceEnabled=false;rc(function(){var a=window.wlAsyncInit;if(a&&typeof a===l)a.call()})}function se(){return false}function kd(){return false}function fd(){var b=Windows.Networking.BackgroundTransfer,a=function(a){try{var b=a.attachAsync().then(function(){},function(){},function(){})}catch(c){}};b.BackgroundDownloader.getCurrentDownloadsAsync(vc).then(function(b){if(b&&b.size>0)for(i=0;i<b.size;i++)a(b[i])});b.BackgroundUploader.getCurrentUploadsAsync(Gc).then(function(b){if(b&&b.size>0)for(i=0;i<b.size;i++)a(b[i])})}function Xd(c){var b=a._pendingLogin;if(b!=null){if(!c)L(Wb);return false}return true}function Wd(a,b){a[r]=a[r]||X;return new Ub(Qc,a.normalizedScope,a,b)}function vd(c,b){return new Ub(S,a._authScope,c,b)}function ge(c){try{var e=zc(),g="/oauth20_logout.srf?",b={},d=a._session.get(m);b[m]=d;b[ab]=d;b["ts"]=(new Date).getTime();var f="https://"+e+g+O(b);Rb(f,S,function(){var a=new Windows.Security.Authentication.OnlineId.OnlineIdAuthenticator;a.signOutUserAsync();c()})}catch(h){L(h);c()}}function dd(a){p(a,[{name:r,allowedValues:[X,Ld],type:b,optional:true},{name:Q,allowedValues:[be,re,le,Dc,cb],type:b,optional:true}],"WL.ui(name:'signin')");a[r]=a[r]||X;a[Q]=a[Q]||Dc}function Dd(a){var b=a[Q],f=a[r],e=qd(b,f),d=rd(b),c='<button style="text-align: center;">'+e+d+"</button>";return c}function qd(a,d){var b="";if(a!==cb){var c=a+(d===X?"_white.png":"_black.png");b='<img alt="" src="'+Rc()+"/SignInControl/"+c+'" style="vertical-align: middle;">'}return b}function rd(a){var b=a!==cb?'<span style="margin: 0px 4px; text-align: center; vertical-align: middle;"></span>':"";return b}F.prototype.setText=function(a){if(this._element.childNodes.length==0){tb(this);return}if(a!=this._text){var b=this._element.childNodes[0],c=this._properties[Q]===cb?b:b.childNodes[1];we(c,a);this._text=a}};F.prototype.onMouseDown=function(){this.mousedown=true;hb(this)};F.prototype.onMouseUp=function(){this.mousedown=false;hb(this)};F.prototype.onMouseEnter=function(){this.mousein=true;hb(this)};F.prototype.onMouseLeave=function(){this.mousein=false;hb(this)};function hb(a){var c=a._properties,d=c[Q];if(d===cb)return;if(a._element.childNodes.length==0){tb(a);return}var g=a._element.childNodes[0].childNodes[0],h=c[r],b=h===X,f=a.mousedown&&a.mousein;b=f?!b:b;var e=d+(b?"_white.png":"_black.png");g.src=Rc()+"/SignInControl/"+e}function ld(a,b){a._button=b;b.addEventListener("click",V("click",a,a.onClick),false);b.addEventListener("mouseenter",V("mouseenter",a,a.onMouseEnter),false);b.addEventListener("mouseleave",V("mouseleave",a,a.onMouseLeave),false);document.addEventListener("mousedown",V("mousedown",a,a.onMouseDown),false);document.addEventListener("mouseup",V("mouseup",a,a.onMouseUp),false)}function tb(a){var b=a._button;if(b){b.removeEventListener("click",W("click",a),false);b.removeEventListener("mouseenter",W("mouseenter",a),false);b.removeEventListener("mouseleave",W("mouseleave",a),false);document.removeEventListener("mousedown",W("mousedown",a),false);document.removeEventListener("mouseup",W("mouseup",a),false);delete a._button}}function Ic(){return null}var Ub=function(b,f,c,d){var a=this;a._display=b;a._completed=false;a._requestFired=false;a._properties=c;a._callback=d;a._scope=f;var e=b===S?"WL.login":"WL.getLoginStatus";a._promise=new h(e,null,null)};Ub.prototype={execute:function(){var b=this,d=Be(b._display,b._scope,b._properties[r]),c=q(b,b._onComplete);if(a._isConnected)oe(Windows.Security.Authentication.OnlineId.CredentialPromptType.doNotPrompt,function(){Rb(d,b._display,c)});else Rb(d,b._display,c);return b._promise},_onComplete:function(d){if(!this._completed){this._completed=true;a._session.onAuthResponse(d);var c=false,b=a._session.tryGetResponse();if(this._display===S)c=d[z]===k||b==null;else c=d[f]==null;var b=c?d:b;this._callback(this._properties,b);if(c)this._promise[o](b);else this._promise[j](b)}}};function Be(c,g,h){var d=c===S?Gb:a._response_type,b={};b[m]=a._session.get(m);b[Ge]=c;b[Ke]=a._locale;b[ab]=a._redirect_uri;b[mb]=d;b[e]=g;if(c==Qc)b[r]=h;var f=zc(),i="https://"+f+"/oauth20_authorize.srf?"+O(b);return i}function Rb(h,j,b){try{g("launching WebAuth");var i=new Windows.Foundation.Uri(h),c=function(c){var a=null;if(c.name==="Error")a=Nb(k,c.number+": "+c.message);else if(c.responseData)a=ie(c.responseData);if(!a||!a[f]&&!a[z])a=Nb(k,"Failed to get result from Live OAuth endpoint.");b(a)},a=Windows.Security.Authentication.Web,d=a.WebAuthenticationBroker,e=j===S?a.WebAuthenticationOptions.silentMode:a.WebAuthenticationOptions.none;d.authenticateAsync(e,i).then(c,c)}catch(l){response=Nb(k,"Failed to launch WebAuthBroker: "+l);b(response)}}function oe(g,d){var c=function(b){if(b&&b.number===gd)a._isConnected=false;d()};try{var b=Windows.Security.Authentication.OnlineId,f=new b.OnlineIdAuthenticator,h=new b.OnlineIdServiceTicketRequest(Od(),"JWT"),e=f.authenticateUserAsync([h],"",g||b.CredentialPromptType.promptIfNeeded);e.then(c,c)}catch(i){d()}}T.prototype.initPlatformSpecific=function(){this._statusChecked=this._state[d]!==G};T.prototype.getStatus=function(){var b=null,c=this._state[d];if(c===n){var g=this.tokenExpiresIn();if(g<=10)c=rb;else if(g<60)c=qb;if(c===rb&&!a._isConnected){this.updateStatus(y);c=y}else{b={};b[f]=this._state[f];b[x]=this._state[x];b[e]=this._state[e].split(" ");b[R]=g;b[U]=this._state[U]}}else if(!this._statusChecked)c=G;return {status:c,session:b}};T.prototype.tryGetResponse=function(c){g("AuthSession.tryGetResponse: scope = "+c);var a=this.getStatus(),b=a[d],f=a[Wc];if(b==G||b==qb||b==rb)return null;if(c)return f&&qe(f[e],c)?a:null;else return a};T.prototype.onAuthResponse=function(b){var i=false,a=this._state,j=a[d],h=b[f];if(h&&a[f]!=h){a[f]=h;a[e]=b[e];a[R]=b[R];a[U]=Ac()+parseInt(b[R]);if(b[x])a[x]=b[x];else delete a[x];this._stateDirty=true;i=true}var g=ye(this._state,b);if(j!=g){this._statusChecked=true;a[d]=g;this._stateDirty=true;this.onStatusChanged(j,g)}if(i)c.notify(gb,this.getNormalStatus());this.save()};function ye(c,e){var a=c[d],b=e[z];if(c[f])a=n;else if(b===yc)a=y;else if(b===oc)a=Fc;else if(a!=G)a=y;return a}function zb(a){return a===G?y:a===qb||a===rb?n:a}function ee(b){var c=function(){Pd(b)};a.getLoginStatus({internal:true,callback:c})}function Ne(){return true}function zc(){return a._settings[a._env][Tc]}function Cc(){return a._settings[a._env][Nc]}a.download=function(a){v("WL.download");return (new xc(a)).execute()};function ic(b,e){if(!Qb(b))b=Cc()+(b.charAt(0)==="/"?b.substring(1):b);var c=e||{},d=mc();if(d)c[f]=d;c[C]=a[C];return Fb(b,c)}function hd(b,g,a){var e=Qb(b)?b:ic(b),f=new Windows.Foundation.Uri(e);try{var c=new Windows.Networking.BackgroundTransfer.BackgroundDownloader;c.group=vc;var h=c.createDownload(f,g),d=h.startAsync().then(function(b){a.downloadComplete(true,b||{})},function(b){bc(b.message,a)},function(d){var b=d.progress,c={bytesTransferred:b.bytesReceived,totalBytes:b.totalBytesToReceive,progressPercentage:b.totalBytesToReceive==0?0:b.bytesReceived/b.totalBytesToReceive*100};a.downloadProgress(c)});a._cancel=q(d,d.cancel)}catch(i){bc(i.message,a)}}function Qb(a){return a.indexOf("https://")===0||a.indexOf("http://")===0}function bc(a,b){b.downloadComplete(false,u(k,"WL.download:"+a))}var ac="notStarted",jc="ready",sb="downloadCompleted",Xb="downloadFailed",cc="canceled",sd="completed";function xc(a){if(!(a[Cb]instanceof Windows.Storage.StorageFile))throw new Error("WL.download: unsupported file_output object type");this._properties=a;this._status=ac}xc.prototype={execute:function(){this._promise=new h("WL.download",this,null);this._process();return this._promise},cancel:function(){this._status=cc;if(this._cancel)try{this._cancel()}catch(a){}else{this._result=u(Kb,Ib.replace("METHOD","WL.download"));this._process()}},downloadComplete:function(b,c){var a=this;a._result=c;a._status=b?sb:Xb;a._process()},downloadProgress:function(a){this._promise[t](a)},_process:function(){switch(this._status){case ac:this._start();break;case jc:this._download();break;case sb:case Xb:case cc:this._complete()}},_start:function(){var b=this;a.getLoginStatus({internal:true,callback:function(){b._status=jc;b._process()}})},_download:function(){var b=this,a=b._properties,d=a[w],c=a[Cb];hd(d,c,b)},_complete:function(){var a=this,c=a._result,d=a._status===sb?j:o;a._status=sd;var b=a._properties[D];if(b)b(c);a._promise[d](c)}};a.upload=function(a){v("WL.upload");return (new Jc(a)).execute()};function fe(a){if(a instanceof Windows.Storage.StorageFile)return true;else if(a instanceof File)return true;return false}function Je(a,b,d){var c={};c[Zb]="true";a=Fb(a,c);if(b instanceof Windows.Storage.StorageFile)id(a,b,d);else if(b instanceof File)ke(a,b,d)}function ke(d,c,a){var b=new FileReader;b.readAsArrayBuffer(c);b.onload=function(e){var c=e.target.result,b=new XMLHttpRequest;b.open("PUT",d,true);b.onload=function(b){Db(b.currentTarget.responseText,a)};b.onerror=function(b){wb(b.currentTarget.statusText,a)};b.onprogress=function(){};a._cancel=q(b,b.abort);b.send(c)}}function id(g,f,a){var e=new Windows.Foundation.Uri(g);try{var b=new Windows.Networking.BackgroundTransfer.BackgroundUploader;b.group=Gc;b.method="PUT";var c=b.createUpload(e,f),d=c.startAsync().then(function(){var f="",b=c.getResultStreamAt(0);if(b){var e=new Windows.Storage.Streams.DataReader(b),d=function(b){if(b)var c=e.readString(b);Db(c,a)};e.loadAsync(10000).then(d,d)}else Db(f,a)},function(b){wb(b.message,a)},function(d){var b=d.progress,c={bytesTransferred:b.bytesSent,totalBytes:b.totalBytesToSend,progressPercentage:b.totalBytesToSend==0?0:b.bytesSent/b.totalBytesToSend*100};a.uploadProgress(c)});a._cancel=q(d,d.cancel)}catch(h){wb(h.message,a)}}function od(f,d,c,e){var g=d||c.name,h=f+g,b={};b[Eb]=e;b[C]=a[C];return ic(h,b)}function Db(a,c){a=a?J(a):"";var b=a!==""?Hc(a):null;b=b||{};c.uploadComplete(b.error==null,b)}function wb(a,b){b.uploadComplete(false,u(k,"WL.upload:"+a))}var dc="notStarted",ec="authReady",vb="uploadReady",ub="uploadCompleted",fb="uploadFailed",gc="canceled",yd="completed";function Jc(a){if(!fe(a[lb]))throw new Error("WL.upload: unsupported file_input object type");this._properties=a;this._status=dc}Jc.prototype={execute:function(){this._promise=new h("WL.upload",this,null);this._process();return this._promise},cancel:function(){this._status=gc;if(this._cancel)try{this._cancel()}catch(a){}else{this._result=u(Kb,Ib.replace("METHOD","WL.upload"));this._process()}},uploadComplete:function(b,c){var a=this;a._result=c;a._status=b?ub:fb;a._process()},uploadProgress:function(a){this._promise[t](a)},_process:function(){switch(this._status){case dc:this._start();break;case ec:this._getUploadPath();break;case vb:this._upload();break;case ub:case fb:case gc:this._complete()}},_start:function(){var b=this;a.getLoginStatus({internal:true,callback:function(){b._status=ec;b._process()}})},_getUploadPath:function(){var b=this,c=b._properties,d=c[w];if(Qb(d)){b._uploadPath=d;b._status=vb;b._process();return}a.api({path:d}).then(function(g){var a=g.upload_location;if(a){var e=c[qc],d=c[lb],f=!!c[Eb];b._uploadPath=od(a,e,d,f);b._status=vb}else{b._result=u(k,"WL.upload: Failed to get upload_location of the resource.");b._status=fb}b._process()},function(a){b._result=a;b._status=fb;b._process()})},_upload:function(){var a=this;Je(a._uploadPath,a._properties[lb],a)},_complete:function(){var a=this,c=a._result,d=a._status===ub?j:o;a._status=yd;var b=a._properties[D];if(b)b(c);a._promise[d](c)}};function rc(a){var b=document.readyState;if(b==="complete"||document.body!==null)a();else window.addEventListener("DOMContentLoaded",a,false)}function De(b,a){MSApp.execUnsafeLocalFunction(function(){b.innerHTML=a})}a._version="5.0.3267.0402";if(!a._settings)a._settings={};var Qe=a._settings,Tb={},He="login.live.com";Tb[Nc]="https://apis.live.net/v5.0/";Tb[Tc]=He;Qe["PROD"]=Tb;function Od(){switch(a._env){case "PROD":case "BETA":return "jwt.oauth.live.net";default:return "jwt.oauth.live-int.net"}}a.onloadInit()}})();